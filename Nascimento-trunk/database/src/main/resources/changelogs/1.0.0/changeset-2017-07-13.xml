<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

	<changeSet author="pzenida"
		id="2017-07-13-add-receipt-to-birth-registration">
		<addColumn tableName="birth_registration">
			<column name="key_receipt" type="bigint(20)" />
		</addColumn>
	</changeSet>

	<changeSet author="pzenida"
		id="2017-07-13-add-receipt-to-birth-registration-fk">
		<addForeignKeyConstraint constraintName="fk_receipt_on_birth_registration"
			referencedTableName="birth_registration_document" baseColumnNames="key_receipt"
			baseTableName="birth_registration" referencedColumnNames="id" />
	</changeSet>

	<changeSet author="pzenida" id="2017-07-13-add-revision-table">
		<sql>
			<![CDATA[
CREATE TABLE `revision` (
  `id` int(11) NOT NULL,
  `operation` varchar(255) DEFAULT NULL,
  `timestamp` bigint(20) DEFAULT NULL,
  `username` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`)
) ENGINE=InnoDB
			]]>
		</sql>
	</changeSet>

	<changeSet author="pzenida"
		id="2017-07-13-add-birth-registration-audit-table">
		<sql>
			<![CDATA[
CREATE TABLE `birth_registration_audit` (
  `id` bigint(20) NOT NULL,
  `key_revision` int(11) NOT NULL,
  `revtype` tinyint(4) DEFAULT NULL,
  `birth_registration_status` varchar(255) DEFAULT NULL,
  `last_birth_registration_status_date` datetime DEFAULT NULL,
  `observation` varchar(255) DEFAULT NULL,
  `rejection_reason` varchar(255) DEFAULT NULL,
  PRIMARY KEY (`id`,`key_revision`),
  KEY `fk_revision_on_birth_registration_audit` (`key_revision`),
  CONSTRAINT `fk_revision_on_birth_registration_audit` FOREIGN KEY (`key_revision`) REFERENCES `revision` (`id`)
) ENGINE=InnoDB
			]]>
		</sql>
	</changeSet>

</databaseChangeLog>