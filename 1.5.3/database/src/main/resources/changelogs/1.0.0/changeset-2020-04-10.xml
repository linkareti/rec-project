<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<databaseChangeLog xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
	xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd http://www.liquibase.org/xml/ns/dbchangelog http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-3.4.xsd">

	<changeSet author="pmatrola" id="2020-04-10-update-message-template-notify_second_parent_with_confirmation_url_remove_hospital">
		<sql>
			<![CDATA[
update message_template set subject = 'Declaração de Nascimento Online n.º ${birthRegistration.registrationNumber}',
content = '<p>Caro(a) ${birthRegistration.secondParent.name},</p>
<p>No seguimento da declaração de nascimento online submetida por ${birthRegistration.firstParent.name} queira, 
por favor, aceder ao link abaixo para aceitação/rejeição da declaração até à data limite de ${date.format("dd-MM-yyyy", $expirationDate)}.</p>

<p><a href="${configuration.applicationBaseUrl}/public/birth_registration/birth_registration.xhtml?uuid=${birthRegistration.uuid}">http://nascimento.justica.gov.pt</a></p>

<p>Ao autenticar-se com o seu Cartão do Cidadão ou Chave Móvel Digital ser-lhe-á apresentada a informação detalhada da declaração, devendo em seguida proceder à sua aceitação/rejeição.</p>
<p>Só após a aceitação da declaração será a mesma remetida a uma conservatória para elaboração do registo.</p>

#if(${configuration.emailContactsBlock})<p>Para mais esclarecimentos sobre este processo deverá contactar:
${configuration.emailContactsBlock}</p>#end

<p>Os nossos melhores cumprimentos,</p>
<p>A equipa do Nascimento Online</p>' where code = 'NOTIFY_SECOND_PARENT_WITH_CONFIRMATION_URL'
			]]>
		</sql>
		<rollback />
	</changeSet>
		<changeSet author="pmatrola"
		id="2020-04-10-update-notify-first-parent-about-submission-when-confirmation-required-message-template_remove_hospital">
		
		<sql>
			<![CDATA[
update message_template set content = '<p>Caro(a) ${birthRegistration.firstParent.name},</p>
<p>Recebemos com sucesso a sua declaração de nascimento online que ficou registado com o n.º ${birthRegistration.registrationNumber}.</p>

<p>Foi enviada uma mensagem de notificação a ${birthRegistration.secondParent.name} para que aceda ao sítio da Internet 
<a href="${configuration.applicationBaseUrl}/public/birth_registration/birth_registration.xhtml?uuid=${birthRegistration.uuid}">http://nascimento.justica.gov.pt</a>, e 
aceite/rejeite a declaração. Só após a aceitação expressa e autenticada, com Cartão do Cidadão ou Chave Móvel Digital de ${birthRegistration.secondParent.name}, a declaração será remetida a uma conservatória para elaboração do registo.</p>


<p>Aproveitamos ainda para lhe lembrar que o prazo de confirmação da declaração de nascimento online por parte de ${birthRegistration.secondParent.name} termina em 
${date.format("dd-MM-yyyy HH:mm", $expirationDate)}, sendo a declaração automaticamente cancelada se o referido prazo for ultrapassado.

#if(${configuration.emailContactsBlock})<p>Para mais esclarecimentos sobre este processo deverá contactar:
${configuration.emailContactsBlock}</p>#end

<p>Os nossos melhores cumprimentos,</p>
<p>A equipa do Nascimento Online</p>'  where code='NOTIFY_FIRST_PARENT_ABOUT_SUBMISSION_WHEN_CONFIRMATION_REQUIRED'
			]]>
		</sql>
		<rollback />
	</changeSet>
	<changeSet author="pmatrola"
		id="2020-04-10-update-notify-first-parent-about-submission-when-confirmation-not-required-message-template_remove_hospital">
		
		<sql>
			<![CDATA[
update message_template set content = '<p>Caro(a) ${birthRegistration.firstParent.name},</p>
<p>Recebemos com sucesso a sua declaração de nascimento online que ficou registado com o n.º ${birthRegistration.registrationNumber}.</p>

<p>A declaração será remetida a uma conservatória para elaboração do registo.</p>

#if(${configuration.emailContactsBlock})<p>Para mais esclarecimentos sobre este processo deverá contactar:
${configuration.emailContactsBlock}</p>#end

<p>Os nossos melhores cumprimentos,</p>
<p>A equipa do Nascimento Online</p>' where code= 'NOTIFY_FIRST_PARENT_ABOUT_SUBMISSION_WHEN_CONFIRMATION_NOT_REQUIRED'
			]]>
		</sql>
	<rollback />
	</changeSet>
		<changeSet author="pmatrola"
		id="2020-04-10-update-notify-parents-on-second-parent-confirmation-message-template_remove_hospital">
		
		<sql>
			<![CDATA[
update  message_template set content ='<p>Caros(as) ${birthRegistration.firstParent.name} e ${birthRegistration.secondParent.name},</p>
<p>A declaração de nascimento online nº. ${birthRegistration.registrationNumber}, submetida por ${birthRegistration.firstParent.name}, foi aceite por ${birthRegistration.secondParent.name}.</p>

<p>A declaração será remetida a uma conservatória para elaboração do registo.</p>

#if(${configuration.emailContactsBlock})<p>Para mais esclarecimentos sobre este processo deverá contactar:
${configuration.emailContactsBlock}</p>#end

<p>Os nossos melhores cumprimentos,</p>
<p>A equipa do Nascimento Online</p>' where code ='NOTIFY_PARENTS_ON_SECOND_PARENT_CONFIRMATION'
			]]>
		</sql>
<rollback />
	</changeSet>
	
	
</databaseChangeLog>