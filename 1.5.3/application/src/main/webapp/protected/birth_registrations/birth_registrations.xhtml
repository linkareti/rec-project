<?xml version="1.0" encoding="UTF-8"?>
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:pt="http://xmlns.jcp.org/jsf/passthrough"
	xmlns:pe="http://primefaces.org/ui/extensions"
	xmlns:o="http://omnifaces.org/ui"
	template="/WEB-INF/templates/default.xhtml">

	<ui:param name="currentPage" value="birthregistrations" />

	<f:metadata>
		<f:viewAction
			action="#{birthRegistrationListController.checkAccess()}" />
	</f:metadata>

	<ui:define name="content">
		<div class="container">
			<div class="row">
				<div class="col-md-12 search">
					<f:validateBean disabled="true">
						<p:panel id="birthRegistrationsFilter" toggleable="false"
							collapsed="false">
							<legend>
								<h:outputText
									value="#{messages['birthRegistration.filterResults']}" />
							</legend>


							<ui:fragment
								rendered="#{loginBean.hasCivilRegistrationOfficeRole or loginBean.hasManagerRole}">
								<div class="row">
									<div class="col-md-4">
										<p:outputLabel value="#{messages['birthRegistration.name']}"
											for="babyName" />
										<p:inputText id="babyName"
											value="#{birthRegistrationListController.example.babyName}"
											styleClass="col-md-12" style="width: none;" />
										<f:param name="disableValidation" value="#{true}" />
										<p:message for="babyName" />
									</div>
									<div class="col-md-3">
										<p:outputLabel
											value="#{messages['birthRegistrationExample.registrationNumber']}"
											for="registrationNumber" />
										<p:inputText id="registrationNumber"
											value="#{birthRegistrationListController.example.registrationNumber}"
											styleClass="col-md-12" style="width: none;" />
										<f:param name="disableValidation" value="#{true}" />
										<p:message for="registrationNumber" />
									</div>
									<div class="col-md-5">
										<p:outputLabel
											value="#{messages['birthRegistrationExample.hospitalUnit']}"
											for="hospitalUnit" />
										<p:selectOneMenu id="hospitalUnit"
											value="#{birthRegistrationListController.example.hospitalUnitId}"
											styleClass="col-md-12" style="width: none;" filter="true"
											filterMatchMode="contains">
											<f:selectItem noSelectionOption="true"
												itemLabel="#{messages['label.selectOne']}" />
											<f:selectItems value="#{applicationFactory.hospitalUnits}"
												var="hospitalUnit" itemLabel="#{hospitalUnit.name}"
												itemValue="#{hospitalUnit.id}" />
											<p:ajax event="change" update="othersHospitalUnitPanel" />
											<f:param name="disableValidation" value="#{true}" />
										</p:selectOneMenu>
										<p:message for="hospitalUnit" />
									</div>
								</div>

								<h:panelGroup id="othersHospitalUnitPanel" layout="block">
									<ui:fragment
										rendered="#{birthRegistrationListController.isOtherHospitalUnit()}">
										<div class="row">
											<div class="col-md-12">
												<p:outputLabel value="#{messages['label.hospital.other']}"
													for="othersHospitalUnit" />

												<p:autoComplete id="othersHospitalUnit"
													value="#{birthRegistrationListController.example.otherHospitalUnit}"
													completeMethod="#{birthRegistrationListController.completeOtherHospitals}"
													var="hospital" itemLabel="#{hospital}"
													itemValue="#{hospital}" forceSelection="true"
													autoHighlight="true" minQueryLength="1"
													maxResults="#{birthRegistrationListController.numberOfOtherHospitalUnitsToShow}"
													inputStyleClass="col-md-12" style="width: 100%;"
													scrollHeight="300"
													placeholder="#{messages['birthRegistration.hospital.placeholder']}" />

												<p:message for="othersHospitalUnit" />
											</div>
										</div>
									</ui:fragment>
								</h:panelGroup>
							</ui:fragment>

							<div class="row">
								<ui:fragment
									rendered="#{loginBean.hasCivilRegistrationOfficeRole or loginBean.hasManagerRole}">
									<div class="col-md-4">
										<p:outputLabel
											value="#{messages['birthRegistrationExample.status']}"
											for="birthRegistrationStatus" />
										<p:selectOneMenu id="birthRegistrationStatus"
											value="#{birthRegistrationListController.example.status}"
											styleClass="col-md-12" style="width: none;">
											<f:selectItem noSelectionOption="true"
												itemLabel="#{messages['label.selectOne']}" />
											<f:selectItems
												value="#{applicationFactory.birthRegistrationStatuses}"
												var="birthRegistrationStatus"
												itemLabel="#{messages[birthRegistrationStatus.key]}"
												itemValue="#{birthRegistrationStatus}" />
											<f:param name="disableValidation" value="#{true}" />
										</p:selectOneMenu>
										<p:message for="birthRegistrationStatus" />
									</div>
								</ui:fragment>
								<div class="col-md-3">
									<p:outputLabel
										value="#{messages['birthRegistrationExample.start']}"
										for="start" />
									<p:calendar id="start"
										value="#{birthRegistrationListController.example.start}"
										timeZone="#{configurationManager.configuration.timeZone}"
										locale="#{configurationManager.configuration.locale}"
										mask="#{configurationManager.configuration.dateTimeMask}"
										pattern="#{configurationManager.configuration.dateTimePattern}"
										showOn="button" size="16" timeControlType="select"
										yearRange="c-80:c+0" maskAutoClear="false"
										placeholder="#{configurationManager.dateTimePlaceHolder}"
										required="true" />
									<p:message for="start" />
								</div>
								<div class="col-md-3">
									<p:outputLabel
										value="#{messages['birthRegistrationExample.end']}" for="end" />
									<p:calendar id="end"
										value="#{birthRegistrationListController.example.end}"
										timeZone="#{configurationManager.configuration.timeZone}"
										locale="#{configurationManager.configuration.locale}"
										mask="#{configurationManager.configuration.dateTimeMask}"
										pattern="#{configurationManager.configuration.dateTimePattern}"
										showOn="button" size="16" timeControlType="select"
										yearRange="c-80:c+0" maskAutoClear="false"
										placeholder="#{configurationManager.dateTimePlaceHolder}"
										required="true" />
									<p:message for="end" />
								</div>
								<div class="col-md-2">
									<p:commandButton
										action="#{birthRegistrationListController.search}"
										value="#{messages['button.filter']}"
										styleClass="btn ui-priority-primary"
										process="@form:birthRegistrationsFilter"
										update="@form:birthRegistrationListGroup"
										onstart="PF('mainContentBUI').show()"
										oncomplete="PF('mainContentBUI').hide()" partialSubmit="true" />
								</div>
							</div>
						</p:panel>
					</f:validateBean>
				</div>
			</div>
			<div class="row">
				<div class="col-md-12">
					<p:panel id="birthRegistrationsPanel" toggleable="false"
						collapsed="false" styleClass="birthRegistrationsPanel">

						<h:panelGroup id="birthRegistrationListGroup" layout="block">

							<p:dataTable value="#{birthRegistrationListController.dataModel}"
								var="birthRegistration" id="birthRegistrations" paginator="true"
								rows="#{birthRegistrationListController.rows}"
								styleClass="birth-registrations"
								first="#{birthRegistrationListController.first}" lazy="true"
								paginatorPosition="bottom" paginatorAlwaysVisible="false"
								paginatorTemplate="{CurrentPageReport} {FirstPageLink} {PreviousPageLink} {PageLinks} {NextPageLink} {LastPageLink} {RowsPerPageDropdown}"
								currentPageReportTemplate="{startRecord}-{endRecord} de {totalRecords} registos"
								rowsPerPageTemplate="10,25,50" pageLinks="3"
								emptyMessage="#{messages['label.noRegistrations']}"
								reflow="true">

								<f:facet name="header">
									<div class="results-count">
										<h3>
											<ui:fragment
												rendered="#{birthRegistrationListController.dataModel.rowCount == '1'}">
												<h:outputFormat
													value="#{messages['birthRegistrationCount']}">
													<f:param
														value="#{birthRegistrationListController.dataModel.rowCount}" />
												</h:outputFormat>
											</ui:fragment>
											<ui:fragment
												rendered="#{birthRegistrationListController.dataModel.rowCount != '1'}">
												<h:outputFormat
													value="#{messages['birthRegistrationsCount']}">
													<f:param
														value="#{birthRegistrationListController.dataModel.rowCount}" />
												</h:outputFormat>
											</ui:fragment>
										</h3>
									</div>
									<div class="clearfix" />
								</f:facet>
								<p:column width="10">
									<ui:fragment rendered="#{birthRegistration.gender eq 'MALE'}">
										<span class="baby male"></span>
									</ui:fragment>
									<ui:fragment rendered="#{birthRegistration.gender eq 'FEMALE'}">
										<span class="baby female"></span>
									</ui:fragment>
									<ui:fragment
										rendered="#{birthRegistration.gender != 'FEMALE' and birthRegistration.gender != 'MALE' }">
										<span class="baby"></span>
									</ui:fragment>
								</p:column>
								<p:column headerText="#{messages['birthRegistration.name']}"
									colspan="4">
									<p:link outcome="birth_registration_detail">
										<f:param name="id" value="#{birthRegistration.id}" />
										<strong><h:outputText
												value="#{birthRegistration.name}" /></strong>
									</p:link>
								</p:column>
								<p:column
									headerText="#{messages['birthRegistration.hospitalUnit']}"
									rendered="#{loginBean.hasCivilRegistrationOfficeRole or loginBean.hasManagerRole}"
									colspan="3">
									<h:outputText value="#{birthRegistration.hospitalUnit.name}" />
								</p:column>
								<p:column
									headerText="#{messages['birthRegistrationExample.registrationLabel']}"
									colspan="2">
									<h:outputText value="#{birthRegistration.registrationNumber}" />
									<span class="separator"> · </span>
									<h:outputText value="#{birthRegistration.creationDate}">
										<f:convertDateTime
											locale="#{configurationManager.configuration.locale}"
											timeZone="#{configurationManager.configuration.timeZone}"
											pattern="#{configurationManager.configuration.datePattern}" />
									</h:outputText>
								</p:column>
							</p:dataTable>

						</h:panelGroup>
					</p:panel>
				</div>
			</div>
		</div>
	</ui:define>
</ui:composition>