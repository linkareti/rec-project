/*
 * FITSDisplay.java
 *
 * Created on February 2, 2005, 4:57 PM
 */

package pt.utl.ist.elab.client.telescopio.displays;

/**
 *
 * @author Andr√© Neto - LEFT - IST
 */

import com.linkare.rec.impl.i18n.ReCResourceBundle;

import eap.fitsbrowser.FITSFileDisplay;

public class FITSOpen extends javax.swing.JPanel implements com.linkare.rec.impl.client.experiment.ExpDataDisplay,
		com.linkare.rec.impl.client.experiment.ExpDataModelListener {

	/** Creates new form FITSDisplay */
	public FITSOpen() {
		initComponents();
	}

	/**
	 * This method is called from within the constructor to initialize the form.
	 * WARNING: Do NOT modify this code. The content of this method is always
	 * regenerated by the Form Editor.
	 */
	private void initComponents()// GEN-BEGIN:initComponents
	{
		java.awt.GridBagConstraints gridBagConstraints;

		jTabbedPaneOpen = new javax.swing.JTabbedPane();
		jPanel1 = new javax.swing.JPanel();
		jButtonOpen = new javax.swing.JButton();

		setLayout(new java.awt.BorderLayout());

		jPanel1.setLayout(new java.awt.GridBagLayout());

		jButtonOpen.setText(ReCResourceBundle.findString("ReCExpTelescopio$rec.exp.telescopio.lbl.open"));
		jButtonOpen.addActionListener(new java.awt.event.ActionListener() {
			public void actionPerformed(java.awt.event.ActionEvent evt) {
				jButtonOpenActionPerformed(evt);
			}
		});

		jPanel1.add(jButtonOpen, new java.awt.GridBagConstraints());

		jTabbedPaneOpen.addTab(ReCResourceBundle.findString("ReCExpTelescopio$rec.exp.telescopio.lbl.open"), jPanel1);

		add(jTabbedPaneOpen, java.awt.BorderLayout.CENTER);

	}// GEN-END:initComponents

	private void jButtonOpenActionPerformed(java.awt.event.ActionEvent evt)// GEN-FIRST:event_jButtonOpenActionPerformed
	{// GEN-HEADEREND:event_jButtonOpenActionPerformed

		javax.swing.JFileChooser openChooser = new javax.swing.JFileChooser();
		int res = openChooser.showOpenDialog(null);

		if (res == openChooser.APPROVE_OPTION) {
			java.io.File f = openChooser.getSelectedFile();
			FITSFileDisplay ffd = new FITSFileDisplay();
			jTabbedPaneOpen.add(f.getName(), ffd);
			try {
				ffd.load(f);
			} catch (java.io.IOException ioe) {
				ioe.printStackTrace();
			}
		}
	}// GEN-LAST:event_jButtonOpenActionPerformed

	private void saveToFile(java.io.File fName, byte[] data) {
		try {
			java.io.FileOutputStream fos = new java.io.FileOutputStream(fName);
			fos.write(data);
			fos.close();
		} catch (java.io.IOException ioe) {
			ioe.printStackTrace();
		}
	}

	private java.io.File showSaveDialog() {
		javax.swing.JFileChooser saveDialog = new javax.swing.JFileChooser();
		int option = saveDialog.showSaveDialog(null);
		if (option == saveDialog.APPROVE_OPTION)
			return saveDialog.getSelectedFile();

		return null;
	}

	public void dataModelEnded() {
	}

	public void dataModelError() {
	}

	public void dataModelStarted() {
	}

	public void dataModelStartedNoData() {
	}

	public void dataModelStoped() {
	}

	public void dataModelWaiting() {
	}

	public javax.swing.JComponent getDisplay() {
		return this;
	}

	public javax.swing.Icon getIcon() {
		return new javax.swing.ImageIcon(getClass().getResource(
				"/pt/utl/ist/elab/client/telescopio/resources/telescopio_iconified.png"));
	}

	public javax.swing.JMenuBar getMenuBar() {
		return null;
	}

	public javax.swing.JToolBar getToolBar() {
		return null;
	}

	private int dark = -1;
	private int image = -1;
	private int flat = -1;

	public void newSamples(com.linkare.rec.impl.client.experiment.NewExpDataEvent evt) {
	}

	private com.linkare.rec.impl.client.experiment.ExpDataModel model = null;

	public void setExpDataModel(com.linkare.rec.impl.client.experiment.ExpDataModel model) {
		if (this.model != null)
			model.removeExpDataModelListener(this);

		this.model = model;

		if (this.model != null)
			this.model.addExpDataModelListener(this);
	}

	public String getName() {
		return ReCResourceBundle
				.findStringOrDefault("ReCExpTelescopio$rec.exp.display.telescopio.title.3", "FITS Open");
	}

	public static void main(String args[]) {
		ReCResourceBundle.loadResourceBundle("ReCExpTelescopio",
				"recresource:///pt/utl/ist/elab/client/telescopio/resources/messages);
		javax.swing.JFrame dummy = new javax.swing.JFrame();
		FITSOpen p = new FITSOpen();
		dummy.getContentPane().add(p, java.awt.BorderLayout.CENTER);
		dummy.pack();
		dummy.show();
	}

	// Variables declaration - do not modify//GEN-BEGIN:variables
	private javax.swing.JButton jButtonOpen;
	private javax.swing.JPanel jPanel1;
	private javax.swing.JTabbedPane jTabbedPaneOpen;
	// End of variables declaration//GEN-END:variables

}
