<?xml version="1.0" encoding="UTF-8"?>
<!--
		=======================================================
		=== 2009/03/29 Build Rec - Elab General Definitions ===
		=======================================================
	-->

<project name="ReC - general definitions" basedir=".">
	<description>
		Compile, package, sign and run the project ReC and each of the experiments.
	</description>

	<property file="build.properties" description="general properties for building project" />

	<!--
		=====================================================
		====================== Generic ======================
		=====================================================
	-->

	<property name="build.dir.compile" value="${basedir}/${build.dir}/compile" />
	<property name="build.dir.jars" value="${basedir}/${build.dir}/jars" />

	<property name="templates.dir" value="${basedir}/templates" />
	<property name="templates.dir.client" value="${basedir}/templates/client" />
	<property name="templates.dir.openorb" value="${basedir}/templates/openorb" />
	<property name="templates.dir.jnlp" value="${basedir}/templates/jnlp" />
	<property name="templates.dir.scripts" value="${basedir}/templates/scripts" />
	<property name="templates.dir.logs" value="${basedir}/templates/log" />
	<property name="templates.dir.images" value="${basedir}/templates/images" />
	<property name="templates.dir.jmx" value="${basedir}/templates/jmx" />

	<tstamp>
		<format property="timestamp" pattern="dd-MM-yyyy hh:mm" locale="en,UK" />
	</tstamp>

	<tstamp>
		<format property="today" pattern="dd-MM-yyyy" locale="en,UK" />
	</tstamp>

	<macrodef name="process.list">
		<attribute name="list" />
		<attribute name="task" />
		<attribute name="attribute.name" />

		<sequential>
			<script language="javascript">
				<![CDATA[
					var list="@{list}";
					var task="@{task}";
					var attribute_name="@{attribute.name}";
				    var splitVars=list.split(",");
					
				    for(var i=0;i<splitVars.length;i++)
				    {    
						var oTask=project.createTask(task);
						oTask.init();
						oTask.setDynamicAttribute(attribute_name,splitVars[i]);
						oTask.execute();
					}
				]]>
			</script>
		</sequential>
	</macrodef>

	<!--
			=====================================================
			======================= JVLC ========================
			=====================================================
	-->

	<property name="jvlc.classes.dir" value="${build.dir.compile}/classes/jvlc" />
	<property name="jvlc.build.dir" value="${build.dir.jars}/jvlc" />

	<property name="jvlc.src.java.dir" value="${basedir}/other/src/java/JVLC" />

	<property name="other.lib.dir" value="${basedir}/other/lib" />

	<property name="jvlc.lib.dir" value="${other.lib.dir}/java/jvlc/" />

	<path id="jvlc.lib.path">
		<fileset dir="${jvlc.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="jvlc.compile.lib.path">
		<fileset dir="${other.lib.dir}/compile/jvlc/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="jvlc.libs.classpath">
		<path refid="jvlc.lib.path" />
		<path refid="jvlc.compile.lib.path" />
	</path>

	<!--
		=====================================================
		==================== REC Common =====================
		=====================================================
	-->

	<property name="rec.common.classes.dir" value="${build.dir.compile}/classes/rec/common" />
	<property name="common.build.dir" value="${build.dir.jars}/common" />

	<property name="rec.common.src.java.dir" value="${basedir}/rec/src/java/common" />

	<property name="rec.lib.dir" value="${basedir}/rec/lib" />

	<property name="rec.common.lib.dir" value="${rec.lib.dir}/java/common/" />

	<path id="rec.common.lib.path">
		<fileset dir="${rec.common.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.common.compile.lib.path">
		<fileset dir="${rec.lib.dir}/compile/common/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.common.libs.classpath">
		<path refid="rec.common.lib.path" />
		<path refid="rec.common.compile.lib.path" />
	</path>

	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<pathelement location="${rec.lib.dir}/compile/common/ant-contrib-1.0b3.jar" />
		</classpath>
	</taskdef>

	<!--
		=====================================================
		==================== ReC Client =====================
		=====================================================
	-->

	<property name="rec.client.classes.dir" value="${build.dir.compile}/classes/rec/client" />
	<property name="client.build.dir" value="${build.dir.jars}/client" />
	<property name="client.rec.am.resources" value="rec.am/src/main/resources-rec" />
	<property name="client.rec.am.webapp" value="rec.am/src/main/webapp" />

	<property name="rec.client.src.java.dir" value="${basedir}/rec/src/java/client" />
	<property name="rec.ui.src.java.dir" value="${basedir}/rec/src/java/ui" />

	<property name="rec.client.lib.dir" value="${rec.lib.dir}/java/client/" />

	<path id="rec.client.lib.path">
		<fileset dir="${rec.client.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.client.compile.lib.path">
		<fileset dir="${rec.lib.dir}/compile/client/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.client.libs.classpath">
		<path refid="rec.client.lib.path" />
		<path refid="rec.client.compile.lib.path" />
	</path>

	<path id="rec.compile.client.dependencies.classpath">
		<pathelement location="${rec.common.classes.dir}/" />
		<pathelement location="${jvlc.classes.dir}/" />
		<path refid="rec.common.libs.classpath" />
		<path refid="jvlc.libs.classpath" />
	</path>

	<path id="rec.compile.client.classpath">
		<path refid="rec.client.libs.classpath" />
		<path refid="rec.compile.client.dependencies.classpath" />
	</path>

	<!--
		=====================================================
		================ ReC Hardware Server ================
		=====================================================
	-->

	<property name="rec.hardwareserver.classes.dir" value="${build.dir.compile}/classes/rec/hardwareserver" />
	<property name="hardwareserver.build.dir" value="${build.dir.jars}/hardwareserver" />

	<property name="rec.hardwareserver.src.java.dir" value="${basedir}/rec/src/java/hardwareserver" />

	<property name="rec.hardwareserver.lib.dir" value="${rec.lib.dir}/java/hardwareserver/" />

	<path id="rec.hardwareserver.lib.path">
		<fileset dir="${rec.hardwareserver.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.hardwareserver.compile.lib.path">
		<fileset dir="${rec.lib.dir}/compile/hardwareserver/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.hardwareserver.libs.classpath">
		<path refid="rec.hardwareserver.lib.path" />
		<path refid="rec.hardwareserver.compile.lib.path" />
	</path>

	<path id="rec.compile.hardwareserver.dependencies.classpath">
		<pathelement location="${rec.common.classes.dir}/" />
		<path refid="rec.common.libs.classpath" />
	</path>

	<path id="rec.compile.hardwareserver.classpath">
		<path refid="rec.hardwareserver.libs.classpath" />
		<path refid="rec.compile.hardwareserver.dependencies.classpath" />
	</path>

	<!--
		=====================================================
		============= ReC Multicast Controller===============
		=====================================================
	-->

	<property name="rec.multicast.classes.dir" value="${build.dir.compile}/classes/rec/multicast" />
	<property name="multicast.build.dir" value="${build.dir.jars}/multicast" />

	<property name="rec.multicast.src.java.dir" value="${basedir}/rec/src/java/multicast" />

	<property name="rec.multicast.lib.dir" value="${rec.lib.dir}/java/multicast/" />

	<path id="rec.multicast.lib.path">
		<fileset dir="${rec.multicast.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.multicast.compile.lib.path">
		<fileset dir="${rec.lib.dir}/compile/multicast/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="rec.multicastcontroller.libs.classpath">
		<path refid="rec.multicast.lib.path" />
		<path refid="rec.multicast.compile.lib.path" />
	</path>

	<path id="rec.compile.multicastcontroller.dependencies.classpath">
		<pathelement location="${rec.common.classes.dir}/" />
		<path refid="rec.common.libs.classpath" />
	</path>

	<path id="rec.compile.multicastcontroller.classpath">
		<path refid="rec.multicastcontroller.libs.classpath" />
		<path refid="rec.compile.multicastcontroller.dependencies.classpath" />
	</path>


	<path id="run.multicastcontroller.classpath">
		<path refid="rec.common.lib.path" />
		<path refid="rec.multicast.lib.path" />
		<pathelement location="${rec.common.classes.dir}/" />
		<pathelement location="${rec.multicast.classes.dir}/" />
	</path>

	<!--
			=====================================================
			=================== Elab Common =====================
			=====================================================
	-->

	<property name="elab.lib.dir" value="${basedir}/elab/lib" />

	<property name="elab.common.classes.dir" value="${build.dir.compile}/classes/elab/common" />
	<property name="elab.common.src.java.dir" value="${basedir}/elab/src/java/common" />
	<property name="elab.common.lib.dir" value="${elab.lib.dir}/java/common" />

	<path id="elab.common.lib.path">
		<fileset dir="${elab.common.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.common.compile.lib.path">
		<fileset dir="${elab.lib.dir}/compile/common/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.common.libs.classpath">
		<path refid="elab.common.lib.path" />
		<path refid="elab.common.compile.lib.path" />
	</path>

	<path id="elab.compile.common.dependencies.classpath">
		<path refid="rec.common.libs.classpath" />
		<pathelement location="${rec.common.classes.dir}/" />
	</path>

	<path id="elab.compile.common.classpath">
		<path refid="elab.common.libs.classpath" />
		<path refid="elab.compile.common.dependencies.classpath" />
	</path>


	<!--
		=====================================================
		=================== Elab Client =====================
		=====================================================
	-->

	<property name="elab.client.classes.dir" value="${build.dir.compile}/classes/elab/client" />

	<property name="elab.client.src.java.dir" value="${basedir}/elab/src/java/client" />
	<property name="elab.ui.src.java.dir" value="${basedir}/elab/src/java/ui" />

	<property name="elab.lib.dir" value="${basedir}/elab/lib" />

	<property name="elab.client.lib.dir" value="${elab.lib.dir}/java/client/" />

	<path id="elab.client.lib.path">
		<fileset dir="${elab.client.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.client.compile.lib.path">
		<fileset dir="${elab.lib.dir}/compile/client/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.client.libs.classpath">
		<path refid="elab.client.lib.path" />
		<path refid="elab.client.compile.lib.path" />
	</path>

	<path id="elab.compile.client.dependencies.classpath">
		<path refid="rec.client.libs.classpath" />
		<pathelement location="${rec.client.classes.dir}/" />
		<path refid="rec.common.libs.classpath" />
		<pathelement location="${rec.common.classes.dir}/" />
		<path refid="elab.common.libs.classpath" />
		<pathelement location="${elab.common.classes.dir}" />
	</path>

	<path id="elab.compile.client.classpath">
		<path refid="elab.client.libs.classpath" />
		<path refid="elab.compile.client.dependencies.classpath" />
	</path>

	<!--
		=====================================================
		=================== Elab driver =====================
		=====================================================
	-->

	<property name="elab.hardwareserver.classes.dir" value="${build.dir.compile}/classes/elab/hardwareserver" />

	<property name="elab.hardwareserver.src.java.dir" value="${basedir}/elab/src/java/driver" />

	<property name="elab.hardwareserver.lib.dir" value="${elab.lib.dir}/java/driver/" />


	<path id="elab.hardwareserver.lib.path">
		<fileset dir="${elab.hardwareserver.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.hardwareserver.compile.lib.path">
		<fileset dir="${elab.lib.dir}/compile/driver/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.hardwareserver.libs.classpath">
		<path refid="elab.hardwareserver.lib.path" />
		<path refid="elab.hardwareserver.compile.lib.path" />
	</path>

	<path id="elab.compile.hardwareserver.dependencies.classpath">
		<pathelement location="${rec.hardwareserver.classes.dir}/" />
		<path refid="rec.hardwareserver.libs.classpath" />
		<pathelement location="${rec.common.classes.dir}/" />
		<path refid="rec.common.libs.classpath" />
		<path refid="elab.common.libs.classpath" />
		<pathelement location="${elab.common.classes.dir}" />
	</path>

	<path id="elab.compile.hardwareserver.classpath">
		<path refid="elab.hardwareserver.libs.classpath" />
		<path refid="elab.compile.hardwareserver.dependencies.classpath" />
	</path>

	<!--
		=====================================================
		=========== Elab Multicast Controller ===============
		=====================================================
	-->

	<property name="elab.multicast.classes.dir" value="${build.dir.compile}/classes/elab/multicast" />

	<property name="elab.multicast.src.java.dir" value="${basedir}/elab/src/java/multicast" />

	<property name="elab.multicast.lib.dir" value="${elab.lib.dir}/java/multicast/" />

	<path id="elab.multicast.lib.path">
		<fileset dir="${elab.multicast.lib.dir}">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.multicast.compile.lib.path">
		<fileset dir="${elab.lib.dir}/compile/multicast/">
			<include name="**/*.jar" />
		</fileset>
	</path>

	<path id="elab.multicastcontroller.libs.classpath">
		<path refid="elab.multicast.lib.path" />
		<path refid="elab.multicast.compile.lib.path" />
	</path>

	<path id="elab.compile.multicastcontroller.dependencies.classpath">
		<path refid="rec.common.libs.classpath" />
		<pathelement location="${rec.common.classes.dir}/" />
		<path refid="rec.multicastcontroller.libs.classpath" />
		<pathelement location="${rec.multicast.classes.dir}/" />
	</path>

	<path id="elab.compile.multicastcontroller.classpath">
		<path refid="elab.multicastcontroller.libs.classpath" />
		<path refid="elab.compile.multicastcontroller.dependencies.classpath" />
	</path>

	<!--
		=====================================================
		===============ReC Entire Project====================
		=====================================================
	-->

	<macrodef name="create.jnlp.full.client.compile">
		<sequential>
			<copy file="${jnlp.rec.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/rec-framework.jnlp">
				<filterset begintoken="@" endtoken="@" filtersfile="build.properties" />
			</copy>
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}" />
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" propertyFile="build.properties">
				<replacefilter token="@rec.title@" property="rec.title" />
				<replacefilter token="@rec.vendor@" property="rec.vendor" />
				<replacefilter token="@rec.homepage@" property="rec.homepage" />
				<replacefilter token="@rec.description@" property="rec.description" />
				<replacefilter token="@rec.description.oneline@" property="rec.description.oneline" />
				<replacefilter token="@rec.description.tooltip@" property="rec.description.tooltip" />
				<replacefilter token="@rec.description.short@" property="rec.description.short" />
				<replacefilter token="@rec.icon@" property="rec.icon" />
				<replacefilter token="@rec.icon.splash@" property="rec.icon.splash" />
				<replacefilter token="@linkare.home.url@" property="linkare.home.url" />
				<replacefilter token="@linkare.home.title@" property="linkare.home.title" />
				<replacefilter token="@linkare.home.description@" property="linkare.home.description" />
				<replacefilter token="@linkare.home.icon@" property="linkare.home.icon" />
				<replacefilter token="@rec.title.en@" property="rec.title.en" />
				<replacefilter token="@rec.homepage.en@" property="rec.homepage.en" />
				<replacefilter token="@rec.description.en@" property="rec.description.en" />
				<replacefilter token="@rec.description.oneline.en@" property="rec.description.oneline.en" />
				<replacefilter token="@rec.description.tooltip.en@" property="rec.description.tooltip.en" />
				<replacefilter token="@rec.description.short.en@" property="rec.description.short.en" />
				<replacefilter token="@linkare.home.url.en@" property="linkare.home.url.en" />
				<replacefilter token="@linkare.home.title.en@" property="linkare.home.title.en" />
				<replacefilter token="@linkare.home.description.en@" property="linkare.home.description.en" />
				<replacefilter token="@linkare.home.icon@" property="linkare.home.icon" />
			</replace>

			<!--copy file="${jnlp.rec.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/rec-framework.jnlp" />
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}" />
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" propertyFile="build.properties">
				<replacefilter token="@href@" property="href" />
			</replace-->

			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC Client --&gt;" value="&lt;jar href=&quot;ReCClient_sig.jar&quot;/&gt;" />
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC Common --&gt;" value="&lt;jar href=&quot;ReCCommon_sig.jar&quot;/&gt;" />
			<replace file="${elab.client.classes.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC jvlc --&gt;" value="&lt;jar href=&quot;ReCjvlc_sig.jar&quot;/&gt;" />

			<copy file="${jnlp.orb.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/openorb.jnlp" />
			<replace file="${elab.client.classes.dir}/openorb.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/openorb.jnlp" propertyFile="build.properties">
				<replacefilter token="@openorb.title@" property="openorb.title" />
				<replacefilter token="@openorb.vendor@" property="openorb.vendor" />
				<replacefilter token="@openorb.homepage@" property="openorb.homepage" />
				<replacefilter token="@openorb.description@" property="openorb.description" />
				<replacefilter token="@openorb.description.oneline@" property="openorb.description.oneline" />
				<replacefilter token="@openorb.description.tooltip@" property="openorb.description.tooltip" />
				<replacefilter token="@openorb.description.short@" property="openorb.description.short" />
			</replace>

			<copy file="${jnlp.j3d.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/j3d.jnlp">
				<filterset begintoken="@" endtoken="@" filtersfile="build.properties" />
			</copy>
			<replace file="${elab.client.classes.dir}/j3d.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}" />

			<copy file="${jnlp.jfreechart.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/jfreechart.jnlp" />
			<replace file="${elab.client.classes.dir}/jfreechart.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/jfreechart.jnlp" propertyFile="build.properties">
				<replacefilter token="@jfreechart.title@" property="jfreechart.title" />
				<replacefilter token="@jfreechart.vendor@" property="jfreechart.vendor" />
				<replacefilter token="@jfreechart.homepage@" property="jfreechart.homepage" />
				<replacefilter token="@jfreechart.description@" property="jfreechart.description" />
				<replacefilter token="@jfreechart.description.oneline@" property="jfreechart.description.oneline" />
				<replacefilter token="@jfreechart.description.tooltip@" property="jfreechart.description.tooltip" />
				<replacefilter token="@jfreechart.description.short@" property="jfreechart.description.short" />
				<replacefilter token="@jfreechart.icon@" property="jfreechart.icon" />
				<replacefilter token="@jfreechart.icon.splash@" property="jfreechart.icon.splash" />
			</replace>

			<copy file="${jnlp.linuxinstaller.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/linux-vlc-installer.jnlp" />
			<replace file="${elab.client.classes.dir}/linux-vlc-installer.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/linux-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@linux.vlc.intaller.title@" property="linux.vlc.intaller.title" />
				<replacefilter token="@linux.vlc.intaller.vendor@" property="linux.vlc.intaller.vendor" />
				<replacefilter token="@linux.intaller.homepage@" property="linux.intaller.homepage" />
				<replacefilter token="@linux.vlc.intaller.description@" property="linux.vlc.intaller.description" />
				<replacefilter token="@linux.vlc.intaller.description.oneline@" property="linux.vlc.intaller.description.oneline" />
				<replacefilter token="@linux.vlc.intaller.description.tooltip@" property="linux.vlc.intaller.description.tooltip" />
				<replacefilter token="@linux.vlc.intaller.description.short@" property="linux.vlc.intaller.description.short" />
				<replacefilter token="@linux.vlc.intaller.icon@" property="linux.vlc.intaller.icon" />
				<replacefilter token="@linux.vlc.intaller.icon.splash@" property="linux.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@linux.vlc.intaller.title.en@" property="linux.vlc.intaller.title.en" />
				<replacefilter token="@linux.vlc.intaller.homepage.en@" property="linux.vlc.intaller.homepage.en" />
				<replacefilter token="@linux.vlc.intaller.description.en@" property="linux.vlc.intaller.description.en" />
				<replacefilter token="@linux.vlc.intaller.description.oneline.en@" property="linux.vlc.intaller.description.oneline.en" />
				<replacefilter token="@linux.vlc.intaller.description.tooltip.en@" property="linux.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@linux.vlc.intaller.description.short.en@" property="linux.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>

			<copy file="${jnlp.macinstaller.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/macosx-vlc-installer.jnlp" />
			<replace file="${elab.client.classes.dir}/macosx-vlc-installer.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/macosx-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@mac.vlc.intaller.title@" property="mac.vlc.intaller.title" />
				<replacefilter token="@mac.vlc.intaller.vendor@" property="mac.vlc.intaller.vendor" />
				<replacefilter token="@mac.intaller.homepage@" property="mac.intaller.homepage" />
				<replacefilter token="@mac.vlc.intaller.description@" property="mac.vlc.intaller.description" />
				<replacefilter token="@mac.vlc.intaller.description.oneline@" property="mac.vlc.intaller.description.oneline" />
				<replacefilter token="@mac.vlc.intaller.description.tooltip@" property="mac.vlc.intaller.description.tooltip" />
				<replacefilter token="@mac.vlc.intaller.description.short@" property="mac.vlc.intaller.description.short" />
				<replacefilter token="@mac.vlc.intaller.icon@" property="mac.vlc.intaller.icon" />
				<replacefilter token="@mac.vlc.intaller.icon.splash@" property="mac.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@mac.vlc.intaller.title.en@" property="mac.vlc.intaller.title.en" />
				<replacefilter token="@mac.vlc.intaller.homepage.en@" property="mac.vlc.intaller.homepage.en" />
				<replacefilter token="@mac.vlc.intaller.description.en@" property="mac.vlc.intaller.description.en" />
				<replacefilter token="@mac.vlc.intaller.description.oneline.en@" property="mac.vlc.intaller.description.oneline.en" />
				<replacefilter token="@mac.vlc.intaller.description.tooltip.en@" property="mac.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@mac.vlc.intaller.description.short.en@" property="mac.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>

			<copy file="${jnlp.windowsinstaller.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/windows-vlc-installer.jnlp" />
			<replace file="${elab.client.classes.dir}/windows-vlc-installer.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/windows-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@windows.vlc.intaller.title@" property="windows.vlc.intaller.title" />
				<replacefilter token="@windows.vlc.intaller.vendor@" property="windows.vlc.intaller.vendor" />
				<replacefilter token="@windows.intaller.homepage@" property="windows.intaller.homepage" />
				<replacefilter token="@windows.vlc.intaller.description@" property="windows.vlc.intaller.description" />
				<replacefilter token="@windows.vlc.intaller.description.oneline@" property="windows.vlc.intaller.description.oneline" />
				<replacefilter token="@windows.vlc.intaller.description.tooltip@" property="windows.vlc.intaller.description.tooltip" />
				<replacefilter token="@windows.vlc.intaller.description.short@" property="windows.vlc.intaller.description.short" />
				<replacefilter token="@windows.vlc.intaller.icon@" property="windows.vlc.intaller.icon" />
				<replacefilter token="@windows.vlc.intaller.icon.splash@" property="windows.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@windows.vlc.intaller.title.en@" property="windows.vlc.intaller.title.en" />
				<replacefilter token="@windows.vlc.intaller.homepage.en@" property="windows.vlc.intaller.homepage.en" />
				<replacefilter token="@windows.vlc.intaller.description.en@" property="windows.vlc.intaller.description.en" />
				<replacefilter token="@windows.vlc.intaller.description.oneline.en@" property="windows.vlc.intaller.description.oneline.en" />
				<replacefilter token="@windows.vlc.intaller.description.tooltip.en@" property="windows.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@windows.vlc.intaller.description.short.en@" property="windows.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>

			<copy file="${jnlp.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/elab-client.jnlp" />
			<replace file="${elab.client.classes.dir}/elab-client.jnlp" token="@codebase@" value="file://localhost/${client.build.dir}/" />
			<replace file="${elab.client.classes.dir}/elab-client.jnlp" propertyFile="build.properties">
				<replacefilter token="@elab.title@" property="elab.title" />
				<replacefilter token="@elab.vendor@" property="elab.vendor" />
				<replacefilter token="@elab.homepage@" property="elab.homepage" />
				<replacefilter token="@elab.description@" property="elab.description" />
				<replacefilter token="@elab.description.oneline@" property="elab.description.oneline" />
				<replacefilter token="@elab.description.tooltip@" property="elab.description.tooltip" />
				<replacefilter token="@elab.description.short@" property="elab.description.short" />
				<replacefilter token="@elab.icon@" property="elab.icon" />
				<replacefilter token="@elab.icon.splash@" property="elab.icon.splash" />
				<replacefilter token="@elab.title.en@" property="elab.title.en" />
				<replacefilter token="@elab.homepage.en@" property="elab.homepage.en" />
				<replacefilter token="@elab.description.en@" property="elab.description.en" />
				<replacefilter token="@elab.description.oneline.en@" property="elab.description.oneline.en" />
				<replacefilter token="@elab.description.tooltip.en@" property="elab.description.tooltip.en" />
				<replacefilter token="@elab.description.short.en@" property="elab.description.short.en" />
				<replacefilter token="@j2se-version@" property="j2se-version" />
				<replacefilter token="@video.enabled@" property="video.enabled" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
				<replacefilter token="@client.main-class@" property="client.main-class" />
				<replacefilter token="@rec.am.endpoint@" property="rec.am.endpoint" />
				<replacefilter token="@rec.client.processingmanager.threadpool.coresize@" property="rec.client.processingmanager.threadpool.coresize" />
				<replacefilter token="@rec.client.processingmanager.threadpool.maxsize@" property="rec.client.processingmanager.threadpool.maxsize" />
				<replacefilter token="@rec.processingmanager.thread.idletime@" property="rec.processingmanager.thread.idletime" />
                                <replacefilter token="@rec.apparatus.autoconnect.id@" property="rec.apparatus.autoconnect.id" />
			</replace>

			<replace file="${elab.client.classes.dir}/elab-client.jnlp" token="&lt;!-- Jar eLab Client --&gt;" value="&lt;jar href=&quot;ELabClient_sig.jar&quot; main=&quot;true&quot; /&gt;" />

			<process.list task="add.experiment.to.full.jnlp.compile" list="${experiment.list}" attribute.name="experiment.name" />
		</sequential>
	</macrodef>

	<macrodef name="add.experiment.to.full.jnlp.compile">
		<attribute name="experiment.name" />
		<sequential>
			<replace file="${elab.client.classes.dir}/elab-client.jnlp" token="&lt;!--End Experiment Jars--&gt;">
				<replacevalue>
					<![CDATA[<jar href="@temporary.experiment.jar@" lazy="true"/>
					<!--End Experiment Jars-->]]></replacevalue>
			</replace>
			<replace file="${elab.client.classes.dir}/elab-client.jnlp" token="@temporary.experiment.jar@" value="@{experiment.name}Client_sig.jar" />
		</sequential>
	</macrodef>

	<macrodef name="create.jnlp.full.client.build">
		<sequential>

			<copy file="${jnlp.rec.template.file}" overwrite="yes" tofile="${client.build.dir}/rec-framework.jnlp" />
			<replace file="${client.build.dir}/rec-framework.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@rec.title@" property="rec.title" />
				<replacefilter token="@rec.vendor@" property="rec.vendor" />
				<replacefilter token="@rec.homepage@" property="rec.homepage" />
				<replacefilter token="@rec.description@" property="rec.description" />
				<replacefilter token="@rec.description.oneline@" property="rec.description.oneline" />
				<replacefilter token="@rec.description.tooltip@" property="rec.description.tooltip" />
				<replacefilter token="@rec.description.short@" property="rec.description.short" />
				<replacefilter token="@rec.icon@" property="rec.icon" />
				<replacefilter token="@rec.icon.splash@" property="rec.icon.splash" />
				<replacefilter token="@linkare.home.url@" property="linkare.home.url" />
				<replacefilter token="@linkare.home.title@" property="linkare.home.title" />
				<replacefilter token="@linkare.home.description@" property="linkare.home.description" />
				<replacefilter token="@linkare.home.icon@" property="linkare.home.icon" />
				<replacefilter token="@rec.title.en@" property="rec.title.en" />
				<replacefilter token="@rec.homepage.en@" property="rec.homepage.en" />
				<replacefilter token="@rec.description.en@" property="rec.description.en" />
				<replacefilter token="@rec.description.oneline.en@" property="rec.description.oneline.en" />
				<replacefilter token="@rec.description.tooltip.en@" property="rec.description.tooltip.en" />
				<replacefilter token="@rec.description.short.en@" property="rec.description.short.en" />
				<replacefilter token="@linkare.home.url.en@" property="linkare.home.url.en" />
				<replacefilter token="@linkare.home.title.en@" property="linkare.home.title.en" />
				<replacefilter token="@linkare.home.description.en@" property="linkare.home.description.en" />
				<replacefilter token="@linkare.home.icon@" property="linkare.home.icon" />
			</replace>

			<replace file="${client.build.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC Client --&gt;" value="&lt;jar href=&quot;ReCClient_sig.jar&quot;/&gt;" />
			<replace file="${client.build.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC Common --&gt;" value="&lt;jar href=&quot;ReCCommon_sig.jar&quot;/&gt;" />
			<replace file="${client.build.dir}/rec-framework.jnlp" token="&lt;!-- Jar ReC jvlc --&gt;" value="&lt;jar href=&quot;ReCjvlc_sig.jar&quot;/&gt;" />

			<copy file="${jnlp.orb.template.file}" overwrite="yes" tofile="${client.build.dir}/openorb.jnlp" />
			<replace file="${client.build.dir}/openorb.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@openorb.title@" property="openorb.title" />
				<replacefilter token="@openorb.vendor@" property="openorb.vendor" />
				<replacefilter token="@openorb.homepage@" property="openorb.homepage" />
				<replacefilter token="@openorb.description@" property="openorb.description" />
				<replacefilter token="@openorb.description.oneline@" property="openorb.description.oneline" />
				<replacefilter token="@openorb.description.tooltip@" property="openorb.description.tooltip" />
				<replacefilter token="@openorb.description.short@" property="openorb.description.short" />
			</replace>

			<copy file="${jnlp.j3d.template.file}" overwrite="yes" tofile="${client.build.dir}/j3d.jnlp">
				<filterset begintoken="@" endtoken="@" filtersfile="build.properties" />
			</copy>
			<replace file="${client.build.dir}/j3d.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
			</replace>

			<copy file="${jnlp.jfreechart.template.file}" overwrite="yes" tofile="${client.build.dir}/jfreechart.jnlp" />
			<replace file="${client.build.dir}/jfreechart.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@jfreechart.title@" property="jfreechart.title" />
				<replacefilter token="@jfreechart.vendor@" property="jfreechart.vendor" />
				<replacefilter token="@jfreechart.homepage@" property="jfreechart.homepage" />
				<replacefilter token="@jfreechart.description@" property="jfreechart.description" />
				<replacefilter token="@jfreechart.description.oneline@" property="jfreechart.description.oneline" />
				<replacefilter token="@jfreechart.description.tooltip@" property="jfreechart.description.tooltip" />
				<replacefilter token="@jfreechart.description.short@" property="jfreechart.description.short" />
				<replacefilter token="@jfreechart.icon@" property="jfreechart.icon" />
				<replacefilter token="@jfreechart.icon.splash@" property="jfreechart.icon.splash" />
			</replace>

			<copy file="${jnlp.linuxinstaller.template.file}" overwrite="yes" tofile="${client.build.dir}/linux-vlc-installer.jnlp" />
			<replace file="${client.build.dir}/linux-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@linux.vlc.intaller.title@" property="linux.vlc.intaller.title" />
				<replacefilter token="@linux.vlc.intaller.vendor@" property="linux.vlc.intaller.vendor" />
				<replacefilter token="@linux.intaller.homepage@" property="linux.intaller.homepage" />
				<replacefilter token="@linux.vlc.intaller.description@" property="linux.vlc.intaller.description" />
				<replacefilter token="@linux.vlc.intaller.description.oneline@" property="linux.vlc.intaller.description.oneline" />
				<replacefilter token="@linux.vlc.intaller.description.tooltip@" property="linux.vlc.intaller.description.tooltip" />
				<replacefilter token="@linux.vlc.intaller.description.short@" property="linux.vlc.intaller.description.short" />
				<replacefilter token="@linux.vlc.intaller.icon@" property="linux.vlc.intaller.icon" />
				<replacefilter token="@linux.vlc.intaller.icon.splash@" property="linux.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@linux.vlc.intaller.title.en@" property="linux.vlc.intaller.title.en" />
				<replacefilter token="@linux.vlc.intaller.homepage.en@" property="linux.vlc.intaller.homepage.en" />
				<replacefilter token="@linux.vlc.intaller.description.en@" property="linux.vlc.intaller.description.en" />
				<replacefilter token="@linux.vlc.intaller.description.oneline.en@" property="linux.vlc.intaller.description.oneline.en" />
				<replacefilter token="@linux.vlc.intaller.description.tooltip.en@" property="linux.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@linux.vlc.intaller.description.short.en@" property="linux.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>
			<copy file="${jnlp.macinstaller.template.file}" overwrite="yes" tofile="${client.build.dir}/macosx-vlc-installer.jnlp" />
			<replace file="${client.build.dir}/macosx-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@mac.vlc.intaller.title@" property="mac.vlc.intaller.title" />
				<replacefilter token="@mac.vlc.intaller.vendor@" property="mac.vlc.intaller.vendor" />
				<replacefilter token="@mac.intaller.homepage@" property="mac.intaller.homepage" />
				<replacefilter token="@mac.vlc.intaller.description@" property="mac.vlc.intaller.description" />
				<replacefilter token="@mac.vlc.intaller.description.oneline@" property="mac.vlc.intaller.description.oneline" />
				<replacefilter token="@mac.vlc.intaller.description.tooltip@" property="mac.vlc.intaller.description.tooltip" />
				<replacefilter token="@mac.vlc.intaller.description.short@" property="mac.vlc.intaller.description.short" />
				<replacefilter token="@mac.vlc.intaller.icon@" property="mac.vlc.intaller.icon" />
				<replacefilter token="@mac.vlc.intaller.icon.splash@" property="mac.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@mac.vlc.intaller.title.en@" property="mac.vlc.intaller.title.en" />
				<replacefilter token="@mac.vlc.intaller.homepage.en@" property="mac.vlc.intaller.homepage.en" />
				<replacefilter token="@mac.vlc.intaller.description.en@" property="mac.vlc.intaller.description.en" />
				<replacefilter token="@mac.vlc.intaller.description.oneline.en@" property="mac.vlc.intaller.description.oneline.en" />
				<replacefilter token="@mac.vlc.intaller.description.tooltip.en@" property="mac.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@mac.vlc.intaller.description.short.en@" property="mac.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>
			<copy file="${jnlp.windowsinstaller.template.file}" overwrite="yes" tofile="${client.build.dir}/windows-vlc-installer.jnlp" />
			<replace file="${client.build.dir}/windows-vlc-installer.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@windows.vlc.intaller.title@" property="windows.vlc.intaller.title" />
				<replacefilter token="@windows.vlc.intaller.vendor@" property="windows.vlc.intaller.vendor" />
				<replacefilter token="@windows.intaller.homepage@" property="windows.intaller.homepage" />
				<replacefilter token="@windows.vlc.intaller.description@" property="windows.vlc.intaller.description" />
				<replacefilter token="@windows.vlc.intaller.description.oneline@" property="windows.vlc.intaller.description.oneline" />
				<replacefilter token="@windows.vlc.intaller.description.tooltip@" property="windows.vlc.intaller.description.tooltip" />
				<replacefilter token="@windows.vlc.intaller.description.short@" property="windows.vlc.intaller.description.short" />
				<replacefilter token="@windows.vlc.intaller.icon@" property="windows.vlc.intaller.icon" />
				<replacefilter token="@windows.vlc.intaller.icon.splash@" property="windows.vlc.intaller.icon.splash" />
				<replacefilter token="@vlc.home.url@" property="vlc.home.url" />
				<replacefilter token="@vlc.home.title@" property="vlc.home.title" />
				<replacefilter token="@vlc.home.description@" property="vlc.home.description" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@windows.vlc.intaller.title.en@" property="windows.vlc.intaller.title.en" />
				<replacefilter token="@windows.vlc.intaller.homepage.en@" property="windows.vlc.intaller.homepage.en" />
				<replacefilter token="@windows.vlc.intaller.description.en@" property="windows.vlc.intaller.description.en" />
				<replacefilter token="@windows.vlc.intaller.description.oneline.en@" property="windows.vlc.intaller.description.oneline.en" />
				<replacefilter token="@windows.vlc.intaller.description.tooltip.en@" property="windows.vlc.intaller.description.tooltip.en" />
				<replacefilter token="@windows.vlc.intaller.description.short.en@" property="windows.vlc.intaller.description.short.en" />
				<replacefilter token="@vlc.home.url.en@" property="vlc.home.url.en" />
				<replacefilter token="@vlc.home.title.en@" property="vlc.home.title.en" />
				<replacefilter token="@vlc.home.description.en@" property="vlc.home.description.en" />
				<replacefilter token="@vlc.home.icon@" property="vlc.home.icon" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
			</replace>

			<copy file="${jnlp.template.file}" overwrite="yes" tofile="${client.build.dir}/elab-client.jnlp" />
			<replace file="${client.build.dir}/elab-client.jnlp" propertyFile="build.properties">
				<replacefilter token="@codebase@" property="codebase" />
				<replacefilter token="@elab.title@" property="elab.title" />
				<replacefilter token="@elab.vendor@" property="elab.vendor" />
				<replacefilter token="@elab.homepage@" property="elab.homepage" />
				<replacefilter token="@elab.description@" property="elab.description" />
				<replacefilter token="@elab.description.oneline@" property="elab.description.oneline" />
				<replacefilter token="@elab.description.tooltip@" property="elab.description.tooltip" />
				<replacefilter token="@elab.description.short@" property="elab.description.short" />
				<replacefilter token="@elab.icon@" property="elab.icon" />
				<replacefilter token="@elab.icon.splash@" property="elab.icon.splash" />
				<replacefilter token="@elab.title.en@" property="elab.title.en" />
				<replacefilter token="@elab.homepage.en@" property="elab.homepage.en" />
				<replacefilter token="@elab.description.en@" property="elab.description.en" />
				<replacefilter token="@elab.description.oneline.en@" property="elab.description.oneline.en" />
				<replacefilter token="@elab.description.tooltip.en@" property="elab.description.tooltip.en" />
				<replacefilter token="@elab.description.short.en@" property="elab.description.short.en" />
				<replacefilter token="@j2se-version@" property="j2se-version" />
				<replacefilter token="@video.enabled@" property="video.enabled" />
				<replacefilter token="@vlc.plugins.destdir@" property="vlc.plugins.destdir" />
				<replacefilter token="@vlc.plugins.filename@" property="vlc.plugins.filename" />
				<replacefilter token="@client.main-class@" property="client.main-class" />
				<replacefilter token="@rec.am.endpoint@" property="rec.am.endpoint" />
				<replacefilter token="@rec.client.processingmanager.threadpool.coresize@" property="rec.client.processingmanager.threadpool.coresize" />
				<replacefilter token="@rec.client.processingmanager.threadpool.maxsize@" property="rec.client.processingmanager.threadpool.maxsize" />
				<replacefilter token="@rec.processingmanager.thread.idletime@" property="rec.processingmanager.thread.idletime" />
				<replacefilter token="@jnlp.file@" value="elab-client.jnlp" />
                                <replacefilter token="@rec.apparatus.autoconnect.id@" property="rec.apparatus.autoconnect.id" />
			</replace>

			<replace file="${client.build.dir}/elab-client.jnlp" token="&lt;!-- Jar eLab Client --&gt;" value="&lt;jar href=&quot;ELabClient_sig.jar&quot; main=&quot;true&quot; /&gt;" />
			<replace file="${client.build.dir}/elab-client.jnlp" token="&lt;!-- Jar eLab Comon --&gt;" value="&lt;jar href=&quot;ELabCommon_sig.jar&quot; main=&quot;true&quot; /&gt;" />

			<process.list task="add.experiment.to.full.jnlp.build" list="${experiment.list}" attribute.name="experiment.name" />
		</sequential>
	</macrodef>

	<macrodef name="add.experiment.to.full.jnlp.build">
		<attribute name="experiment.name" />
		<sequential>
			<replace file="${client.build.dir}/elab-client.jnlp" token="&lt;!--End Experiment Jars--&gt;">
				<replacevalue>
					<![CDATA[<jar href="@temporary.experiment.jar@" lazy="true"/>
					<!--End Experiment Jars-->]]></replacevalue>
			</replace>
			<replace file="${client.build.dir}/elab-client.jnlp" token="@temporary.experiment.jar@" value="@{experiment.name}Client_sig.jar" />
		</sequential>
	</macrodef>

	<!--
		=====================================================
		================ReC Experiments======================
		=====================================================
	-->

	<property name="experiments.classes.dir" value="${build.dir.compile}/classes/experiments" />
	<property name="experiments.build.dir" value="${build.dir.jars}/experiments" />

	<property name="jnlp.template.file" value="${basedir}/templates/jnlp/elab-client.jnlp.xml" />
	<property name="jnlp.rec.template.file" value="${basedir}/templates/jnlp/rec-framework.jnlp.xml" />

	<property name="jnlp.orb.template.file" value="${basedir}/templates/jnlp/openorb.jnlp.xml" />
	<property name="jnlp.jfreechart.template.file" value="${basedir}/templates/jnlp/jfreechart.jnlp.xml" />
	<property name="jnlp.j3d.template.file" value="${basedir}/templates/jnlp/j3d.jnlp.xml" />

	<property name="jnlp.linuxinstaller.template.file" value="${basedir}/templates/jnlp/linux-vlc-installer.jnlp.xml" />
	<property name="jnlp.macinstaller.template.file" value="${basedir}/templates/jnlp/macosx-vlc-installer.jnlp.xml" />
	<property name="jnlp.windowsinstaller.template.file" value="${basedir}/templates/jnlp/windows-vlc-installer.jnlp.xml" />


	<property name="faceconfig.template.file" value="${basedir}/templates/client/ReCFaceConfigTemplate.xml" />
	<property name="faceconfig.lab.template.file" value="${basedir}/templates/client/ReCFaceConfigLabTemplate.xml" />

	<!--MACROS-->

	<macrodef name="process.list">
		<attribute name="list" />
		<attribute name="task" />
		<attribute name="attribute.name" />

		<sequential>
			<script language="javascript">
				<![CDATA[
					var list="@{list}";
					var task="@{task}";
					var attribute_name="@{attribute.name}";
				    var splitVars=list.split(",");
					
				    for(var i=0;i<splitVars.length;i++)
				    {    
						var oTask=project.createTask(task);
						oTask.init();
						oTask.setDynamicAttribute(attribute_name,splitVars[i]);
						oTask.execute();
					}
				]]>
			</script>
		</sequential>
	</macrodef>



	<!-- = = = = = = = = = = = = = = = = =
          macrodef: create.jar          
         = = = = = = = = = = = = = = = = = -->
	<macrodef name="create.jar">
		<attribute name="destination.folder" />
		<attribute name="jar.name" />
		<attribute name="source.basedir" />

		<sequential>
			<mkdir dir="@{destination.folder}" />
			<jar destfile="@{destination.folder}/@{jar.name}" basedir="@{source.basedir}">
				<manifest>
					<section name="common">
						<attribute name="Specification-Title" value="${com.linkare.rec.spec.title}" />
						<attribute name="Specification-Version" value="${com.linkare.rec.spec.version}" />
						<attribute name="Specification-Vendor" value="${com.linkare.rec.spec.title}" />
						<attribute name="Implementation-Title" value="${com.linkare.rec.impl.title}" />
						<attribute name="Implementation-Version" value="${com.linkare.rec.impl.version} ${TODAY}" />
						<attribute name="Implementation-Vendor" value="${com.linkare.rec.impl.vendor}" />
					</section>
				</manifest>
			</jar>
		</sequential>
	</macrodef>

	<!-- = = = = = = = = = = = = = = = = =
          macrodef: sign.jar          
         = = = = = = = = = = = = = = = = = -->
	<macrodef name="sign.jar.rec">
		<attribute name="folder" />
		<attribute name="jar.name" />
		<sequential>

			<signjar storetype="${rec.storetype}" destDir="@{folder}" keystore="${rec.keystore}" keypass="${rec.keypass}" storepass="${rec.storepass}" alias="${rec.alias}">
				<fileset dir="@{folder}" includes="@{jar.name}" excludes="*_sig.jar" />
				<globmapper from="*.jar" to="*_sig.jar" />
			</signjar>

		</sequential>
	</macrodef>

	<macrodef name="sign.jar.elab">
		<attribute name="folder" />
		<attribute name="jar.name" />
		<sequential>

			<signjar storetype="${elab.storetype}" destDir="@{folder}" keystore="${elab.keystore}" keypass="${elab.keypass}" storepass="${elab.storepass}" alias="${elab.alias}">
				<fileset dir="@{folder}" includes="@{jar.name}" excludes="*_sig.jar" />
				<globmapper from="*.jar" to="*_sig.jar" />
			</signjar>

		</sequential>
	</macrodef>

	<!--/MACROS-->

	<!--
		================================================================
		========================== Libraries ===========================
		================================================================
		-->

	<macrodef name="sign.all.jars.in.directory.rec.certificate">
		<attribute name="source.dir.name" />
		<attribute name="destination.dir.name" />
		<sequential>
			<mkdir dir="@{destination.dir.name}" />

			<signjar storetype="${rec.storetype}" destDir="@{destination.dir.name}" keystore="${rec.keystore}" keypass="${rec.keypass}" storepass="${rec.storepass}" alias="${rec.alias}">
				<fileset dir="@{source.dir.name}" includes="**/*.jar" excludes="**/*_sig.jar" />
				<globmapper from="*.jar" to="*_sig.jar" />
			</signjar>

		</sequential>
	</macrodef>

	<macrodef name="sign.all.jars.in.directory.elab.certificate">
		<attribute name="source.dir.name" />
		<attribute name="destination.dir.name" />
		<sequential>
			<mkdir dir="@{destination.dir.name}" />

			<signjar storetype="${elab.storetype}" destDir="@{destination.dir.name}" keystore="${elab.keystore}" keypass="${elab.keypass}" storepass="${elab.storepass}" alias="${elab.alias}">
				<fileset dir="@{source.dir.name}" includes="**/*.jar" excludes="**/*_sig.jar" />
				<globmapper from="*.jar" to="*_sig.jar" />
			</signjar>

		</sequential>
	</macrodef>

	<macrodef name="repack.all.jars.in.directory">
		<attribute name="dir" />
		<sequential>
			<p200ant repack="true">
				<fileset dir="@{dir}">
					<include name="**/*.jar" />
				</fileset>
			</p200ant>
		</sequential>
	</macrodef>

	<macrodef name="repack.jar">
		<attribute name="file" />
		<sequential>
			<p200ant repack="true">
				<fileset file="@{file}" />
			</p200ant>
		</sequential>
	</macrodef>

	<!--
		================================================================
		========================== Javadocs ============================
		================================================================
		-->

	<taskdef name="p200ant" classname="de.matthiasmann.p200ant.P200AntTask" classpath="${rec.lib.dir}/compile/common/p200ant.jar" />

	<condition property="use.pack200">
		<istrue value="${generate.pack200}" />
	</condition>

	<macrodef name="pack.200.all.jar.in.dir">
		<attribute name="dir" />
		<sequential>
			<p200ant destdir="@{dir}">
				<fileset dir="@{dir}">
					<include name="*_sig.jar" />
				</fileset>
			</p200ant>
		</sequential>
	</macrodef>

	<macrodef name="pack.200.jar">
		<attribute name="file" />
		<sequential>
			<p200ant>
				<fileset file="@{file}" />
			</p200ant>
		</sequential>
	</macrodef>

	<path id="compile.experiment.client.classpath">
		<pathelement location="${rec.common.classes.dir}" />
		<path refid="rec.common.libs.classpath" />
		<pathelement location="${rec.client.classes.dir}" />
		<pathelement location="${rec.ui.classes.dir}" />
		<path refid="rec.client.libs.classpath" />
		<pathelement location="${elab.common.classes.dir}" />
		<path refid="elab.common.libs.classpath" />
		<pathelement location="${elab.client.classes.dir}" />
		<path refid="elab.client.libs.classpath" />
	</path>

	<path id="compile.experiment.driver.classpath">
		<pathelement location="${rec.common.classes.dir}" />
		<path refid="rec.common.libs.classpath" />
		<pathelement location="${rec.hardwareserver.classes.dir}" />
		<path refid="rec.hardwareserver.libs.classpath" />
		<pathelement location="${elab.common.classes.dir}" />
		<path refid="elab.common.libs.classpath" />
		<pathelement location="${elab.hardwareserver.classes.dir}" />
		<path refid="elab.hardwareserver.libs.classpath" />
	</path>


	<macrodef name="create.faceconfig">
		<sequential>
			<copy file="${faceconfig.template.file}" overwrite="yes" tofile="${elab.client.classes.dir}/ReCFaceConfig.xml" />

			<process.list task="add.lab.faceconfig" list="${lab.list}" attribute.name="lab.name" />

		</sequential>
	</macrodef>

	<macrodef name="add.lab.faceconfig">
		<attribute name="lab.name" />
		<sequential>

			<loadfile property="@{lab.name}.faceconfig" srcFile="${faceconfig.lab.template.file}" />

			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="&lt;!--End Lab configuration--&gt;">
				<replacevalue>
					<![CDATA[@temporary.lab@
			<!--End Lab configuration-->]]></replacevalue>
			</replace>
			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="@temporary.lab@" value="${@{lab.name}.faceconfig}" />

			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" propertyFile="build.properties">
				<replacefilter token="@multicast.controller.host@" property="@{lab.name}.multicast.controller.host" />
				<replacefilter token="@multicast.controller.port@" property="@{lab.name}.multicast.controller.port" />
				<replacefilter token="@lab.name@" property="@{lab.name}.rec.am.lab.id" />
			</replace>

			<process.list task="add.experiment.faceconfig" list="${@{lab.name}.experiment.list}" attribute.name="experiment.name" />

			<!-- experiment apparatus comments -->
			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="&lt;!--Start Apparatus configuration--&gt;" value="&lt;!--Start @{lab.name} Apparatus configuration--&gt;" />
			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="&lt;!--End Apparatus configuration--&gt;" value="&lt;!--End @{lab.name} Apparatus configuration--&gt;" />

		</sequential>
	</macrodef>

	<macrodef name="add.experiment.faceconfig">
		<attribute name="experiment.name" />
		<sequential>

			<loadfile property="@{experiment.name}.faceconfig" srcFile="experiments/@{experiment.name}/etc/ReCFaceConfig.xml" />

			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="&lt;!--End Apparatus configuration--&gt;">
				<replacevalue>
					<![CDATA[@temporary.experiment.apparatus@
			<!--End Apparatus configuration-->]]></replacevalue>
			</replace>
			<replace file="${elab.client.classes.dir}/ReCFaceConfig.xml" token="@temporary.experiment.apparatus@" value="${@{experiment.name}.faceconfig}" />
		</sequential>
	</macrodef>

</project>